# æ…ˆå–„æ´»åŠ¨ç½‘ç«™ - ä¸­æ–‡å¯åŠ¨æŒ‡å—

ä¸€ä¸ªä½¿ç”¨ Node.jsã€Expressã€MySQL å’ŒåŸç”Ÿ JavaScript æ„å»ºçš„å®Œæ•´åŠ¨æ€æ…ˆå–„æ´»åŠ¨ç½‘ç«™ã€‚

## åŠŸèƒ½ç‰¹æ€§

### ğŸ¯ æ ¸å¿ƒåŠŸèƒ½
- **æ´»åŠ¨ç®¡ç†**: åˆ›å»ºã€è¯»å–ã€æ›´æ–°å’Œåˆ é™¤æ…ˆå–„æ´»åŠ¨
- **ç”¨æˆ·æ³¨å†Œ**: ç”¨æˆ·å¯ä»¥æ³¨å†Œå‚åŠ æ´»åŠ¨ï¼ŒåŒ…å«éªŒè¯åŠŸèƒ½
- **ç®¡ç†é¢æ¿**: å®Œæ•´çš„æ´»åŠ¨ç®¡ç†åå°ç•Œé¢
- **å¤©æ°”é›†æˆ**: ä¸ºæœ‰åæ ‡çš„æ´»åŠ¨æ˜¾ç¤ºå¤©æ°”é¢„æŠ¥
- **å“åº”å¼è®¾è®¡**: ç°ä»£åŒ–ã€ç§»åŠ¨ç«¯å‹å¥½çš„ç•Œé¢

### ğŸ—ï¸ æ¶æ„è®¾è®¡
- **åç«¯**: Node.js + Express RESTful API
- **æ•°æ®åº“**: MySQLï¼Œå…·æœ‰é€‚å½“çš„å…³ç³»å’Œçº¦æŸ
- **å‰ç«¯**: åŸç”Ÿ JavaScript ä¸ DOM æ“ä½œ
- **æ ·å¼**: ç°ä»£åŒ– CSS æ·±è‰²ä¸»é¢˜

## æ•°æ®åº“æ¶æ„

### æ´»åŠ¨è¡¨ (Events)
```sql
CREATE TABLE events (
  id INT AUTO_INCREMENT PRIMARY KEY,
  name VARCHAR(200) NOT NULL,
  date DATE NOT NULL,
  location VARCHAR(255) NOT NULL,
  description TEXT,
  status ENUM('upcoming', 'completed') DEFAULT 'upcoming',
  latitude DECIMAL(10, 8) NULL,
  longitude DECIMAL(11, 8) NULL
);
```

### æ³¨å†Œè¡¨ (Registrations)
```sql
CREATE TABLE registrations (
  id INT AUTO_INCREMENT PRIMARY KEY,
  event_id INT NOT NULL,
  user_name VARCHAR(100) NOT NULL,
  email VARCHAR(255) NOT NULL,
  phone VARCHAR(20),
  ticket_count INT DEFAULT 1,
  registration_date DATETIME DEFAULT CURRENT_TIMESTAMP,
  CONSTRAINT fk_registrations_event FOREIGN KEY (event_id) REFERENCES events(id) ON DELETE CASCADE
);
```

## API æ¥å£

### å…¬å…±æ¥å£
- `GET /api/events` - è·å–æ‰€æœ‰æ´»åŠ¨
- `GET /api/events/:id` - è·å–æ´»åŠ¨è¯¦æƒ…åŠæ³¨å†Œä¿¡æ¯
- `POST /api/registrations` - æ³¨å†Œå‚åŠ æ´»åŠ¨

### ç®¡ç†æ¥å£
- `GET /api/admin/events` - è·å–æ‰€æœ‰æ´»åŠ¨ï¼ˆç®¡ç†å‘˜è§†å›¾ï¼‰
- `POST /api/admin/events` - åˆ›å»ºæ–°æ´»åŠ¨
- `PUT /api/admin/events/:id` - æ›´æ–°æ´»åŠ¨
- `DELETE /api/admin/events/:id` - åˆ é™¤æ´»åŠ¨ï¼ˆå¸¦éªŒè¯ï¼‰

## å®‰è£…ä¸é…ç½®

### 1. å…‹éš†ä»“åº“
```bash
git clone <repository-url>
cd charity-events
```

### 2. å®‰è£…ä¾èµ–
```bash
npm install
```

### 3. æ•°æ®åº“é…ç½®
```bash
# åˆ›å»ºæ•°æ®åº“å’Œè¡¨
mysql -u root -p < sql/schema.sql

# æ’å…¥ç¤ºä¾‹æ•°æ®
mysql -u root -p < sql/seed.sql
```

### 4. ç¯å¢ƒé…ç½®
åœ¨æ ¹ç›®å½•åˆ›å»º `.env` æ–‡ä»¶ï¼š
```env
DB_HOST=localhost
DB_PORT=3306
DB_USER=root
DB_PASSWORD=your_password
DB_NAME=charityevents_db
PORT=3000
```

### 5. å¯åŠ¨æœåŠ¡å™¨
```bash
npm start
```

### 6. è®¿é—®åº”ç”¨
- ä¸»ç«™: http://localhost:3000
- ç®¡ç†é¢æ¿: http://localhost:3000/admin/index.html

## ä½¿ç”¨æŒ‡å—

### ç”¨æˆ·ä½¿ç”¨
1. **æµè§ˆæ´»åŠ¨**: è®¿é—®é¦–é¡µæŸ¥çœ‹å³å°†ä¸¾è¡Œçš„æ´»åŠ¨
2. **æœç´¢æ´»åŠ¨**: ä½¿ç”¨æœç´¢é¡µé¢æŒ‰æ—¥æœŸã€åœ°ç‚¹æˆ–å…³é”®è¯ç­›é€‰æ´»åŠ¨
3. **æŸ¥çœ‹æ´»åŠ¨è¯¦æƒ…**: ç‚¹å‡»ä»»æ„æ´»åŠ¨æŸ¥çœ‹å®Œæ•´è¯¦æƒ…å’Œå·²æ³¨å†Œå‚ä¸è€…
4. **æ³¨å†Œæ´»åŠ¨**: ç‚¹å‡»"æ³¨å†Œæ­¤æ´»åŠ¨"è¿›è¡ŒæŠ¥å
5. **å¤©æ°”ä¿¡æ¯**: æœ‰åæ ‡çš„æ´»åŠ¨ä¼šæ˜¾ç¤ºå¤©æ°”é¢„æŠ¥

### ç®¡ç†å‘˜ä½¿ç”¨
1. **è®¿é—®ç®¡ç†é¢æ¿**: å¯¼èˆªåˆ° `/admin/index.html`
2. **ç®¡ç†æ´»åŠ¨**: 
   - åœ¨ç½‘æ ¼å¸ƒå±€ä¸­æŸ¥çœ‹æ‰€æœ‰æ´»åŠ¨
   - æ·»åŠ æ–°æ´»åŠ¨ï¼Œå¯é€‰æ‹©æ·»åŠ åæ ‡ä»¥æ˜¾ç¤ºå¤©æ°”
   - ç¼–è¾‘ç°æœ‰æ´»åŠ¨
   - åˆ é™¤æ´»åŠ¨ï¼ˆä»…å½“æ— æ³¨å†Œè®°å½•æ—¶ï¼‰
3. **æ´»åŠ¨éªŒè¯**: ç³»ç»Ÿé˜²æ­¢åˆ é™¤æœ‰æ³¨å†Œè®°å½•çš„æ´»åŠ¨

## å…³é”®åŠŸèƒ½è¯´æ˜

### ä¸šåŠ¡é€»è¾‘
- **æ¯ç”¨æˆ·æ¯æ´»åŠ¨ä¸€æ¬¡æ³¨å†Œ**: ç”¨æˆ·ä¸èƒ½ä¸ºåŒä¸€æ´»åŠ¨å¤šæ¬¡æ³¨å†Œ
- **æ´»åŠ¨åˆ é™¤ä¿æŠ¤**: æœ‰æ³¨å†Œè®°å½•çš„æ´»åŠ¨æ— æ³•åˆ é™¤
- **è¾“å…¥éªŒè¯**: å‰ç«¯å’Œåç«¯å¯¹æ‰€æœ‰è¡¨å•è¿›è¡ŒéªŒè¯
- **é”™è¯¯å¤„ç†**: å…¨é¢çš„é”™è¯¯å¤„ç†ï¼Œæä¾›ç”¨æˆ·å‹å¥½çš„æ¶ˆæ¯

### å¤©æ°”é›†æˆ
- ä½¿ç”¨ Open-Meteo APIï¼ˆå…è´¹ï¼Œæ— éœ€ API å¯†é’¥ï¼‰
- æ˜¾ç¤ºå¤©æ°”å›¾æ ‡ã€æ¸©åº¦å’Œæè¿°
- ä»…å¯¹æœ‰æœ‰æ•ˆåæ ‡çš„æ´»åŠ¨æ˜¾ç¤º
- å¤©æ°”æ•°æ®ä¸å¯ç”¨æ—¶ä¼˜é›…é™çº§

### å®‰å…¨ç‰¹æ€§
- ä½¿ç”¨å‚æ•°åŒ–æŸ¥è¯¢é˜²æ­¢ SQL æ³¨å…¥
- HTML è½¬ä¹‰é˜²æ­¢ XSS æ”»å‡»
- è¾“å…¥éªŒè¯å’Œæ¸…ç†
- é€‚å½“çš„é”™è¯¯å¤„ç†ï¼Œä¸æ³„éœ²æ•æ„Ÿä¿¡æ¯

## æ–‡ä»¶ç»“æ„

```
â”œâ”€â”€ server/                    # æœåŠ¡å™¨ç«¯
â”‚   â”œâ”€â”€ index.js              # ä¸»æœåŠ¡å™¨æ–‡ä»¶
â”‚   â”œâ”€â”€ db/
â”‚   â”‚   â””â”€â”€ event_db.js       # æ•°æ®åº“è¿æ¥
â”‚   â””â”€â”€ routes/
â”‚       â”œâ”€â”€ events.js         # å…¬å…±æ´»åŠ¨è·¯ç”±
â”‚       â”œâ”€â”€ admin.js          # ç®¡ç†æ´»åŠ¨è·¯ç”±
â”‚       â””â”€â”€ registrations.js  # æ³¨å†Œè·¯ç”±
â”œâ”€â”€ public/                   # å‰ç«¯æ–‡ä»¶
â”‚   â”œâ”€â”€ index.html            # é¦–é¡µ
â”‚   â”œâ”€â”€ search.html           # æœç´¢é¡µé¢
â”‚   â”œâ”€â”€ event-detail.html     # æ´»åŠ¨è¯¦æƒ…é¡µé¢
â”‚   â”œâ”€â”€ register.html         # æ³¨å†Œé¡µé¢
â”‚   â”œâ”€â”€ admin/
â”‚   â”‚   â”œâ”€â”€ index.html        # ç®¡ç†ä»ªè¡¨æ¿
â”‚   â”‚   â”œâ”€â”€ add-event.html    # æ·»åŠ æ´»åŠ¨è¡¨å•
â”‚   â”‚   â””â”€â”€ edit-event.html   # ç¼–è¾‘æ´»åŠ¨è¡¨å•
â”‚   â”œâ”€â”€ js/
â”‚   â”‚   â”œâ”€â”€ home.js           # é¦–é¡µé€»è¾‘
â”‚   â”‚   â”œâ”€â”€ search.js         # æœç´¢åŠŸèƒ½
â”‚   â”‚   â”œâ”€â”€ event-detail.js   # æ´»åŠ¨è¯¦æƒ…é€»è¾‘
â”‚   â”‚   â”œâ”€â”€ register.js       # æ³¨å†Œé€»è¾‘
â”‚   â”‚   â””â”€â”€ admin/
â”‚   â”‚       â”œâ”€â”€ admin-events.js
â”‚   â”‚       â”œâ”€â”€ add-event.js
â”‚   â”‚       â””â”€â”€ edit-event.js
â”‚   â””â”€â”€ styles.css            # ä¸»æ ·å¼è¡¨
â”œâ”€â”€ sql/                      # æ•°æ®åº“æ–‡ä»¶
â”‚   â”œâ”€â”€ schema.sql            # æ•°æ®åº“æ¶æ„
â”‚   â””â”€â”€ seed.sql              # ç¤ºä¾‹æ•°æ®
â””â”€â”€ package.json
```

## æµ‹è¯•åº”ç”¨

1. **å¯åŠ¨æœåŠ¡å™¨** å¹¶è®¿é—® http://localhost:3000
2. **æµè§ˆæ´»åŠ¨** åœ¨é¦–é¡µæŸ¥çœ‹
3. **æœç´¢æ´»åŠ¨** ä½¿ç”¨ä¸åŒç­›é€‰æ¡ä»¶
4. **æŸ¥çœ‹æ´»åŠ¨è¯¦æƒ…** å¹¶æŸ¥çœ‹æ³¨å†Œä¿¡æ¯
5. **æ³¨å†Œæ´»åŠ¨** ä½¿ç”¨æ³¨å†Œè¡¨å•
6. **è®¿é—®ç®¡ç†é¢æ¿** ç®¡ç†æ´»åŠ¨
7. **æµ‹è¯•å¤©æ°”é›†æˆ** ä½¿ç”¨æœ‰åæ ‡çš„æ´»åŠ¨

## ç¤ºä¾‹æ•°æ®

åº”ç”¨åŒ…å« 10 ä¸ªç¤ºä¾‹æ´»åŠ¨å’Œ 13 ä¸ªç¤ºä¾‹æ³¨å†Œï¼Œæ¶µç›–å„ç§åœºæ™¯ï¼š
- ä¸åŒç±»å‹çš„æ´»åŠ¨ï¼ˆé©¬æ‹‰æ¾ã€ç ”è®¨ä¼šã€æ¸…æ´æ´»åŠ¨ç­‰ï¼‰
- æ¾³å¤§åˆ©äºšå„åœ°çš„ä¸åŒåœ°ç‚¹
- å³å°†ä¸¾è¡Œå’Œå·²å®Œæˆçš„æ´»åŠ¨æ··åˆ
- æ¯ä¸ªæ´»åŠ¨çš„å¤šä¸ªæ³¨å†Œ
- æœ‰åæ ‡å’Œæ— åæ ‡çš„æ´»åŠ¨ç”¨äºå¤©æ°”æµ‹è¯•

## æµè§ˆå™¨å…¼å®¹æ€§

- æ”¯æŒ ES6+ çš„ç°ä»£æµè§ˆå™¨
- å“åº”å¼è®¾è®¡åœ¨ç§»åŠ¨ç«¯å’Œæ¡Œé¢ç«¯éƒ½èƒ½æ­£å¸¸å·¥ä½œ
- å‰ç«¯æ— å¤–éƒ¨ä¾èµ–ï¼ˆé™¤å¤©æ°” API å¤–ï¼‰

## å¸¸è§é—®é¢˜

### Q: å¦‚ä½•ä¿®æ”¹æ•°æ®åº“è¿æ¥ä¿¡æ¯ï¼Ÿ
A: ç¼–è¾‘ `.env` æ–‡ä»¶ä¸­çš„æ•°æ®åº“é…ç½®å‚æ•°ã€‚

### Q: å¦‚ä½•æ·»åŠ æ–°çš„æ´»åŠ¨ç±»å‹ï¼Ÿ
A: åœ¨æ•°æ®åº“çš„ `events` è¡¨ä¸­ï¼Œ`status` å­—æ®µå¯ä»¥æ‰©å±•ä¸ºåŒ…å«æ›´å¤šçŠ¶æ€ã€‚

### Q: å¤©æ°”åŠŸèƒ½ä¸å·¥ä½œæ€ä¹ˆåŠï¼Ÿ
A: ç¡®ä¿æ´»åŠ¨æœ‰æœ‰æ•ˆçš„ç»çº¬åº¦åæ ‡ï¼Œå¹¶æ£€æŸ¥ç½‘ç»œè¿æ¥ã€‚

### Q: å¦‚ä½•å¤‡ä»½æ•°æ®ï¼Ÿ
A: ä½¿ç”¨ MySQL çš„ mysqldump å‘½ä»¤å¤‡ä»½æ•°æ®åº“ã€‚

## å¼€å‘è¯´æ˜

### æ·»åŠ æ–°åŠŸèƒ½
1. åœ¨ `server/routes/` ä¸­æ·»åŠ æ–°çš„è·¯ç”±æ–‡ä»¶
2. åœ¨ `public/js/` ä¸­æ·»åŠ å¯¹åº”çš„å‰ç«¯é€»è¾‘
3. æ›´æ–°æ•°æ®åº“æ¶æ„ï¼ˆå¦‚éœ€è¦ï¼‰
4. æµ‹è¯•æ‰€æœ‰åŠŸèƒ½

### éƒ¨ç½²åˆ°ç”Ÿäº§ç¯å¢ƒ
1. è®¾ç½®ç”Ÿäº§æ•°æ®åº“
2. é…ç½®ç¯å¢ƒå˜é‡
3. ä½¿ç”¨ PM2 æˆ–ç±»ä¼¼å·¥å…·ç®¡ç†è¿›ç¨‹
4. é…ç½®åå‘ä»£ç†ï¼ˆå¦‚ Nginxï¼‰

## è®¸å¯è¯

æœ¬é¡¹ç›®ç”¨äºæ•™è‚²ç›®çš„ã€‚å¯è‡ªç”±ä½¿ç”¨å’Œä¿®æ”¹ã€‚

---

**æ³¨æ„**: è¿™æ˜¯ä¸€ä¸ªå­¦ä¹ é¡¹ç›®ï¼Œå±•ç¤ºäº†ç°ä»£ Web å¼€å‘çš„æœ€ä½³å®è·µã€‚åœ¨ç”Ÿäº§ç¯å¢ƒä¸­ä½¿ç”¨å‰ï¼Œè¯·ç¡®ä¿è¿›è¡Œé€‚å½“çš„å®‰å…¨å®¡æŸ¥å’Œæµ‹è¯•ã€‚